<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Resultado del Viaje</title>
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="{{ url_for('static', filename='js/video_control.js') }}" defer></script>
    <script src="{{ url_for('static', filename='js/chroma_key.js') }}" defer></script>
</head>
<body>
    <div id="loader-overlay" class="loader-overlay">
        <div class="loader-spinner"></div>
    </div>
    <video autoplay muted loop id="video-background" class="video-background">
        <!-- Asegúrate de que la ruta al video es correcta -->
        <source src="{{ url_for('static', filename='videos/background.mp4') }}" type="video/mp4">
        Tu navegador no soporta videos de fondo.
    </video>

    {% if adivinado %}
        <!-- Canvas donde se mostrará el video sin fondo -->
        <canvas id="celebration-canvas" class="celebration-video"></canvas>
        <!-- Video oculto con fondo verde que sirve como fuente -->
        <video id="celebration-video-source" loop muted playsinline style="display: none;">
            <source src="{{ url_for('static', filename='videos/celebration.mp4') }}" type="video/mp4" />
        </video>
    {% endif %}
    <div class="container">
        <h1>🛰️ Bitácora Final de la Adivinanza 🛰️</h1>

        {% if adivinado and personaje %}
            <h2 class="success">🎉 ¡Éxito en el Viaje! ¡Lo tengo! 🎉</h2>
            <p class="character-name">Estabas pensando en <strong>{{ personaje }}</strong>.</p>
            <p>El Genio del Expreso Astral ha demostrado su conocimiento de la galaxia. ¡Sube al Tren!</p>
        {% else %}
            <h2 class="failure">😔 ¡Error de Navegación! ¡Me has superado! 😔</h2>
            <p>Se me acabaron las preguntas o no pude filtrar la información correctamente.</p>
            {% if candidatos %}
                <p>Los posibles candidatos restantes eran: **{{ candidatos|join(', ') }}**.</p>
                <p>Mi base de conocimiento necesita una actualización urgente. ¿En quién pensabas?</p>
            {% else %}
                <p>No encontré ningún personaje que coincidiera. Mi tren necesita más datos sobre esa persona.</p>
            {% endif %}
        {% endif %}

        <a href="/" class="restart-link">Volver a empezar la aventura</a>
    </div>
</body>
</html>